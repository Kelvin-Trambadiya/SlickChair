@(user: Option[Person],
  currentRole: PersonRole.PersonRole,
  menu: List[(play.api.mvc.Call, String)]
)(implicit request: play.api.mvc.Request[Any])

@import securesocial.core.providers.utils.RoutesHelper
@import models.PersonRole._

@idSize = @{ models.newId.value.toString.size }
@toString(role: PersonRole) = {
  @role match {
    case Chair => { Chair }
    case Reviewer => { PC Member }
    case Submitter => { Author }
  }
}
@changeRole(to: PersonRole) = {
  @to match {
    case Chair => { @routes.Sql.query }
    case Reviewer => { @routes.Reviewing.papers }
    case Submitter => { @routes.Submitting.make }
  }
}

<div class="navbar-header">
  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a href="@routes.About.about" class="navbar-brand">SlickChair Demo</a>
</div>

<div class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    @menu.map { case (url, text) =>
      <li @if(request.uri.takeRight(idSize) equals url.toString.takeRight(idSize)) { class="active" }><a href="@url">@text</a></li>
    }
  </ul>
  
@user match {
  case None => {
    <p class="navbar-text pull-right">
      <a href="#" class="navbar-link">Disconnected</a>
    </p>
  }
  case Some(p) => {
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">@p.email 
        @(p.role, currentRole) match {
          case (Submitter, Submitter) => {}
          case (_, role) => { (@toString(role).toString.trim) }
        }
        <b class="caret"></b></a>
        <ul class="dropdown-menu">
          @if(p.role != Submitter) { 
            @List(Chair, Reviewer, Submitter).dropWhile(_ != p.role).map { role =>
              @if(role == currentRole) {
                <li><a class="disabeled">Change role to @toString(role)</a></li>
              } else {
                <li><a href="@changeRole(role)">Change role to @toString(role)</a></li>
              }
            }
            <li class="divider"></li>
          }
          <li><a href="@RoutesHelper.logout()">Disconnect</a></li>
        </ul>
      </li>
    </ul>
  }
}

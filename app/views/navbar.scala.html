@(user: Option[Person],
  userRole: Option[PersonRole.PersonRole],
  currentRole: PersonRole.PersonRole,
  menu: List[(play.api.mvc.Call, String)]
)(implicit request: play.api.mvc.Request[Any])

@import securesocial.core.providers.utils.RoutesHelper
@import models.PersonRole._

@idSize = @{ 1 /* models.newId.value.toString.size */ }
@toString(role: PersonRole) = {
  @role match {
    case Chair => { Chair }
    case Reviewer => { PC Member }
    case Submitter => { Author }
  }
}
@changeRole(to: PersonRole) = {
  @to match {
    case Chair => { @routes.Sql.query }
    case Reviewer => { @routes.Reviewing.bid }
    case Submitter => { @routes.Submitting.submit }
  }
}

<div class="navbar-header">
  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a href="#" class="navbar-brand">SlickChair Demo</a>
  @* <a href="@routes.About.about" class="navbar-brand">SlickChair Demo</a> *@
</div>

<div class="collapse navbar-collapse">
  <ul class="nav navbar-nav">
    @menu.map { case (url, text) =>
      <li @if(request.uri.takeRight(idSize) equals url.toString.takeRight(idSize)) { class="active" }><a href="@url">@text</a></li>
    }
  </ul>
  
  @*case (Some(Person(_, _, _, email, _)), Some(Submitter), Submitter) => {
    <p class="navbar-text pull-right">
      @email â€” <a href="@RoutesHelper.logout()" class="navbar-link">Sign out</a>
    </p>
  }*@
@(user, userRole, currentRole) match {
  case (Some(Person(_, _, _, email, _)), Some(role), _) => {
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">@email (@toString(currentRole).toString.trim) <b class="caret"></b></a>
        <ul class="dropdown-menu">
          @List(Chair, Reviewer, Submitter).dropWhile(_ != role).map { role =>
            @if(role == currentRole) {
              <li><a class="disabeled">Change role to @toString(role)</a></li>
            } else {
              <li><a href="@changeRole(role)">Change role to @toString(role)</a></li>
            }
          }
          <li class="divider"></li>
          <li><a href="@RoutesHelper.logout()">Sign out</a></li>
        </ul>
      </li>
    </ul>
  }
  case _ => {}
}
